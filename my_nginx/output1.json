{"platform":{"name":"debian","release":"11.3","target_id":"245cb0d6-67e5-561e-aff6-5db3f563dc5a"},"profiles":[{"name":"my_nginx","version":"0.1.0","sha256":"65e7ce0d624b7b874741f698f0dc4507b9f133201ca7e839fcdfac19d6143361","title":"InSpec Profile","maintainer":"The Authors","summary":"An InSpec Compliance Profile","license":"Apache-2.0","copyright":"The Authors","copyright_email":"you@example.com","supports":[{"platform":"os"}],"attributes":[],"groups":[{"id":"controls/example.rb","controls":["(generated from example.rb:6 00873ea55bd70ecc6acf027f40e20438)","tmp-1.0","nginx-version","nginx-modules","nginx-conf"],"title":"sample section"}],"controls":[{"id":"(generated from example.rb:6 00873ea55bd70ecc6acf027f40e20438)","title":null,"desc":null,"descriptions":[],"impact":0.5,"refs":[],"tags":{},"code":"","source_location":{"line":92,"ref":"/opt/inspec/embedded/lib/ruby/gems/2.7.0/gems/inspec-core-5.17.4/lib/inspec/control_eval_context.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /tmp is expected to be directory","run_time":0.095157932,"start_time":"2022-06-14T14:09:54+00:00","resource_class":"file","resource_params":"[\"/tmp\"]","resource_id":""}]},{"id":"tmp-1.0","title":"Create /tmp directory","desc":"An optional description...","descriptions":[{"label":"default","data":"An optional description..."}],"impact":0.7,"refs":[],"tags":{},"code":"control \"tmp-1.0\" do                        # A unique ID for this control\n  impact 0.7                                # The criticality, if this control fails.\n  title \"Create /tmp directory\"             # A human-readable title\n  desc \"An optional description...\"\n  describe file(\"/tmp\") do                  # The actual test\n    it { should be_directory }\n  end\nend\n","source_location":{"line":11,"ref":"my_nginx/controls/example.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /tmp is expected to be directory","run_time":0.003334546,"start_time":"2022-06-14T14:09:54+00:00","resource_class":"file","resource_params":"[\"/tmp\"]","resource_id":""}]},{"id":"nginx-version","title":"NGINX version","desc":"The required version of NGINX should be installed.","descriptions":[{"label":"default","data":"The required version of NGINX should be installed."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'nginx-version' do\n  impact 1.0\n  title 'NGINX version'\n  desc 'The required version of NGINX should be installed.'\n  describe nginx do\n    its('version') { should cmp >= '1.10.3' }\n  end\nend\n","source_location":{"line":20,"ref":"my_nginx/controls/example.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Nginx Environment version is expected to cmp >= \"1.10.3\"","run_time":0.000273303,"start_time":"2022-06-14T14:09:54+00:00","resource_class":"nginx","resource_params":"[]","resource_id":""}]},{"id":"nginx-modules","title":"NGINX modules","desc":"The required NGINX modules should be installed.","descriptions":[{"label":"default","data":"The required NGINX modules should be installed."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'nginx-modules' do\n  impact 1.0\n  title 'NGINX modules'\n  desc 'The required NGINX modules should be installed.'\n  describe nginx do\n    its('modules') { should include 'http_ssl' }\n    its('modules') { should include 'stream_ssl' }\n    its('modules') { should include 'mail_ssl' }\n  end\nend\n","source_location":{"line":29,"ref":"my_nginx/controls/example.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Nginx Environment modules is expected to include \"http_ssl\"","run_time":0.004155458,"start_time":"2022-06-14T14:09:54+00:00","resource_class":"nginx","resource_params":"[]","resource_id":""},{"status":"passed","code_desc":"Nginx Environment modules is expected to include \"stream_ssl\"","run_time":0.000110201,"start_time":"2022-06-14T14:09:54+00:00","resource_class":"nginx","resource_params":"[]","resource_id":""},{"status":"passed","code_desc":"Nginx Environment modules is expected to include \"mail_ssl\"","run_time":8.4601e-05,"start_time":"2022-06-14T14:09:54+00:00","resource_class":"nginx","resource_params":"[]","resource_id":""}]},{"id":"nginx-conf","title":"NGINX configuration","desc":"The NGINX config file should owned by root, be writable only by owner, and not writeable or and readable by others.","descriptions":[{"label":"default","data":"The NGINX config file should owned by root, be writable only by owner, and not writeable or and readable by others."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'nginx-conf' do\n  impact 1.0\n  title 'NGINX configuration'\n  desc 'The NGINX config file should owned by root, be writable only by owner, and not writeable or and readable by others.'\n  describe file('/etc/nginx/nginx.conf') do\n    it { should be_owned_by 'root' }\n    it { should be_grouped_into 'root' }\n    it { should_not be_readable.by('others') }\n    it { should_not be_writable.by('others') }\n    it { should_not be_executable.by('others') }\n  end\nend\n","source_location":{"line":40,"ref":"my_nginx/controls/example.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /etc/nginx/nginx.conf is expected to be owned by \"root\"","run_time":0.06641743,"start_time":"2022-06-14T14:09:54+00:00","resource_class":"file","resource_params":"[\"/etc/nginx/nginx.conf\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/nginx/nginx.conf is expected to be grouped into \"root\"","run_time":0.009211929,"start_time":"2022-06-14T14:09:54+00:00","resource_class":"file","resource_params":"[\"/etc/nginx/nginx.conf\"]","resource_id":""},{"status":"failed","code_desc":"File /etc/nginx/nginx.conf is expected not to be readable by others","run_time":0.107961711,"start_time":"2022-06-14T14:09:54+00:00","message":"expected File /etc/nginx/nginx.conf not to be readable by others","resource_class":"file","resource_params":"[\"/etc/nginx/nginx.conf\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/nginx/nginx.conf is expected not to be writable by others","run_time":0.000179502,"start_time":"2022-06-14T14:09:54+00:00","resource_class":"file","resource_params":"[\"/etc/nginx/nginx.conf\"]","resource_id":""},{"status":"passed","code_desc":"File /etc/nginx/nginx.conf is expected not to be executable by others","run_time":8.2801e-05,"start_time":"2022-06-14T14:09:54+00:00","resource_class":"file","resource_params":"[\"/etc/nginx/nginx.conf\"]","resource_id":""}]}],"status":"loaded","status_message":""}],"statistics":{"duration":0.291299578},"version":"5.17.4"}